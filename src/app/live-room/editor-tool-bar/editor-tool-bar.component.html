<div [autoblur]="mode === modeEnums.Audio" (blurred)="switchMode(modeEnums.Audio)">
  <div class="editor-tool-bar" [ngClass]="{'is-closed': isClose}">
    <svg class="border-background" width="104" height="19" viewBox="0 0 104 19" xmlns="http://www.w3.org/2000/svg"><title>Combined-Shape</title><path d="M24.945 10.03C32.21 3.78 41.665 0 52 0c10.336 0 19.79 3.78 27.055 10.03 6.9 5.427 15.54 8.74 24.945 8.958L0 19c9.405-.23 18.046-3.543 24.945-8.97z"/></svg>
    <svg class="border" width="104" height="19" viewBox="0 0 104 19" xmlns="http://www.w3.org/2000/svg"><title>Combined-Shape</title><path d="M24.945 10.03C32.21 3.78 41.665 0 52 0c10.336 0 19.79 3.78 27.055 10.03 6.9 5.427 15.54 8.74 24.945 8.958L0 19c9.405-.23 18.046-3.543 24.945-8.97z"/></svg>

    <span class="btn post-message">
      <i
        class="bi bi-comment"
        (click)="switchMode(modeEnums.Text); focusMessageInput() "
        (contextmenu)="$event.preventDefault()"
        [ngClass]="{activate: mode === modeEnums.Text || mode === modeEnums.At}"
      ></i>
      发言
    </span>

    <div
      class="record-btn-container"
      [ngClass]="{activate: recorder && (recorder.status === recordEnums.Recording || recorder.status === recordEnums.ReadyToCancel)}"
      (touchstart)="startRecord($event)"
      (touchend)="stopRecord($event)"
      (mouseup)="recorder.status === recordEnums.Waitting ? startRecord($event) : stopRecord($event)"
      (touchmove)="panupCancel($event)"
      (contextmenu)="$event.preventDefault()"
    >
      <div class="record-btn">
        <i class="bi bi-mic"></i>
      </div>
    </div>

    <span class="btn settings">
      <i class="bi bi-gear" (click)="switchMode(modeEnums.Setting);"
         (contextmenu)="$event.preventDefault()"></i>
      设置
    </span>
  </div>

  <div class="post-message-container-hidden-wrapper"
       [ngClass]="{activate: mode === modeEnums.Text || mode === modeEnums.At}">
    <div class="post-message-container" #messageContainer>
      <form
        *ngIf="!isInWechat"
        [formGroup]="form"
        name="editInfo"
        class="post-image"
        (contextmenu)="$event.preventDefault()"
      >
        <label class="add-image" for="image-selector">
          <input
            class="file-selector"
            id="image-selector"
            type="file"
            formControlName="images"
            [(ngModel)]="images"
          >
        </label>
        <i class="bi bi-image"></i>
      </form>

      <i class="bi bi-image post-image" *ngIf="isInWechat" (click)="selectImages()"></i>

      <form class="input-wrapper">
        <textarea
          #messageInput
          class="message-input"
          name="messageContent"
          type="text"
          rows="1"
          placeholder="此时此刻你在想什么?"
          (focus)="resetKeyboard()"
          [(ngModel)]="messageContent"
          autoresize
          display-when-focus
          (input)="messageInputChanged()"
        ></textarea>
        <button class="sender" (click)="postMessage();focusMessageInput();">发送</button>
      </form>

      <a class="switcher" (click)="switchMode(modeEnums.Text)" *ngIf="mode === modeEnums.At">
        <i class="bi bi-at-people-keyboard"></i>
      </a>
      <a class="switcher" (click)="switchMode(modeEnums.At)" *ngIf="mode === modeEnums.Text">
        <i class="bi bi-at-people"></i>
      </a>
    </div>
  </div>

  <div class="at-people-keyboard" [ngClass]="{activate: mode === modeEnums.At}">
    <div class="user-row" (click)="changeCommentContent(liveInfo.admin)">
      <img class="avatar" [src]="liveInfo.admin.avatar">
      <div class="name">{{liveInfo.admin.nick}}</div>
      <div class="tick" [ngClass]="{'selected': selected(liveInfo.admin.uid)}"><i class="bi bi-tick"
      ></i></div>
    </div>

    <div class="user-row" *ngFor="let vip of liveInfo.editors" (click)="changeCommentContent(vip)">
      <img class="avatar" [src]="vip.avatar">
      <div class="name">{{vip.nick}}</div>
      <div class="tick" [ngClass]="{'selected': selected(vip.uid)}"><i class="bi bi-tick"></i></div>
    </div>

  </div>

</div>

<recorder class="recorder" #recorder (recordEnd)="recordEnd($event)" (recording)="onrecording()"></recorder>
